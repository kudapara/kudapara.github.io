<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Support Kudakwashe Paradzayi</title>
  <link rel="icon" href="../assets/images/logo.png">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div id="app">
      <header class="sponsor-header">
          <div class="container mb-4">
            <a href="/" class="sponsor-header__btn">Home</a>
          </div>
          <div class="container flex items-center justify-between">
            <div class="sponsor-header__text">
                <h1 class="sponsor-header__title">Please Support Me</h1>
                <p>So that I can sustainably</p>
                <div><span class="sponsor-header__dynamic-text"> Build Awesome Stuff </span></div>
            </div>
            <div class="sponsor-header__avatar">
              <img src="../assets/images/kp.jpg" alt="Kudakwashe Paradzayi">
            </div>
          </div>
        </header>
      
        <section class="payment-methods py-8">
          <div class="container flex justify-between">
            <div class="patreon pr-4">
              <h3 class="mb-4">Support me via Patreon</h3>
              <p class="mb-4">Lorem ipsum dolor sit amet consectetur adipisicing elit. Eos, id! Corrupti, laboriosam!</p>
              <a href="#" class="btn btn-patreon">Choose Patreon</a>
            </div>
            <div class="paynow pl-4">
              <h3 class="mb-4">Support me via Paynow</h3>
              <p class="mb-4">
                Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ea excepturi tenetur quidem!
              </p>
              <p>
                {{ message }}
              </p>
              <div class="paynow-form" :class="{ collapsed: paynowCollapsed }">
                <input type="email" v-model="authemail" class="paynow-form__text-input mb-4" placeholder = "Enter your email address">
                <div class="flex mb-4">
                  <div class="paynow-form__input-label ">$</div>
                  <input type="number" v-model="amount" class="paynow-form__text-input" placeholder="Enter the amount you want to donate">
                </div>
                
                <input type="text" v-model="mobileNumber" class="paynow-form__text-input mb-4" placeholder="Phone number (e.g 0772123456)">

                <div class="flex items-center justify-between mb-4">
                  <label for="ecocash"  class="paynow-form__radio w-1/2-almost text-center" :class="{'paynow-form__radio--active': mobileMoneyProvider === 'ecocash'}"><input id="ecocash" type="radio" value="ecocash" v-model="mobileMoneyProvider"> Ecocash</label>
                  <label for="onemoney" class="paynow-form__radio w-1/2-almost text-center" :class="{'paynow-form__radio--active': mobileMoneyProvider === 'onemoney'}"><input id="onemoney" type="radio" value="onemoney" v-model="mobileMoneyProvider"> Onemoney</label>
                </div>
                <!-- <input type="checkbox" id="mobile-money-btn"> <label for="mobile-money-btn">Use mobile money (Ecocash. OneMoney)</label> -->
      
                <div class="paynow-form__mobile-money collapsed">
                  <input type="text" class="paynow-form__text-input" placeholder = "Enter your phone number">
                </div>
              </div>
              <button id="paynow-btn" href="#" @click="choosePaynow" class="btn btn-paynow mb-4">
                <span v-if="isLoading">making payment...</span>
                <span v-else>
                  {{ paynowCollapsed ? 'Choose Paynow' : 'Pay Now'}}</button>
                </span>
              <img src="../assets/images/payment-methods.svg" alt="">
            </div>
          </div>
        </section>
      
        <!-- <div class="three-dots flex justify-center">
          <span>&nbsp;</span>
          <span>&nbsp;</span>
          <span>&nbsp;</span>
        </div> -->
      
        <section class="short-description py-8">
          <div class="container">
              <h3 class="mb-4">Help the movement move strong</h3>
              <p>
                  Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse sit amet neque ut tellus molestie ullamcorper. Sed ac ornare quam. Ut sed nunc sed massa iaculis porta ac quis nisl. Proin et lectus tempor, finibus quam eget, consectetur tortor. In odio est, condimentum vel nisi a, sodales iaculis tellus. In elementum 
              </p>
              <p>
                Quisque vitae felis et mauris vestibulum cursus. Suspendisse volutpat lorem eros, nec consequat est mattis tempor. Vestibulum quis accumsan felis. Vestibulum eu mi in sapien porta aliquam. Mauris viverra sed elit sed dictum. Integer varius 
              </p>
          
              <p>
                  Duis mollis justo sed egestas finibus. Nullam quis ipsum tellus. Vivamus non velit est. Fusce tempor risus id felis varius mattis. Suspendisse et dolor in purus sollicitudin faucibus at vitae dolor. Phasellus malesuada tincidunt tortor. Fusce eget tristique quam. Mauris id nisi massa. Sed sodales dui diam, at imperdiet justo 
              </p>
          </div>
        </section>
      
        <div class="three-dots flex justify-center">
          <span>&nbsp;</span>
          <span>&nbsp;</span>
          <span>&nbsp;</span>
        </div>
        
        <section class="container py-8 text-center">
          <a href="" class="btn btn-twitter animated bounce">Follow me on twitter</a>
        </section>
      
        <div class="three-dots flex justify-center">
            <span>&nbsp;</span>
            <span>&nbsp;</span>
            <span>&nbsp;</span>
        </div>
        <!-- start of vue controlled articles -->
        <section class="container py-8">
          <h3>My Recent Activity</h3>
          <div class="py-8 flex justify-between">
            <div class="article" v-for="article in recentContent">
              <div>
                <img :src="article.image_url" :alt="article.title" class="article__img">
                <h3 class="article__text mb-4 px-4">{{ article.title }}</h3>
                <p class="px-4">{{ article.description }}</p>
              </div>
              <div class="article__footer flex items-center justify-between py-4 px-4">
              <medium-logo v-if="article.type === 'blog'" class="article__footer-link"></medium-logo>
              <youtube-logo v-else class="article__footer-link"></youtube-logo>
              <button class="btn btn-twitter rounded-full">{{ article.type === 'video' ? 'Watch' : 'Visit'}}</button>
              </div>
            </div>
          </div>
        </section>
        <!--  end of vue controlled articles -->
     
        <footer class="footer container flex justify-between py-8">
          <span>&copy; Kudakwashe Paradzayi 2018</span>
          <div>
            <a href="https://twitter.com/kudapara" class="footer__link no-decoration">Twitter</a>
            <a href="https://github.com/kudapara" class="footer__link no-decoration">Github</a>
            <a href="https://medium.com/@kudapara" class="footer__link no-decoration">Medium</a>
          </div>
        </footer>
  </div>
</body>

<script>
  // var $ = 
  var paynowButton = document.querySelector('#paynow-btn')
  paynowButton.addEventListener('click', function () {
    document.querySelector('.paynow-form').classList.toggle('collapsed')
    paynowButton.innerHTML = document.querySelector('.paynow-form').classList.contains('collapsed') ? 'Choose Paynow' : 'Pay Now'
  })

  var mobileMoneyCheckBox = document.querySelector('#mobile-money-btn')
  mobileMoneyCheckBox.addEventListener('change', function () {
    document.querySelector('.paynow-form__mobile-money').classList.toggle('collapsed')

  })
</script>

<script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.9"></script>
<script>
  
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.5.17/vue.min.js"></script>

<script>
  var mediumLogo = Vue.component('medium-logo', {
    template: '<svg class="article__footer-link" class="svgIcon-use" height="22" width="112" viewBox="0 0 111.5 22"><path d="M56.3 19.5c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5V19c-.7 1.8-2.4 3-4.3 3-3.3 0-5.8-2.6-5.8-7.5 0-4.5 2.6-7.6 6.3-7.6 1.6-.1 3.1.8 3.8 2.4V3.2c0-.3-.1-.6-.3-.7l-1.4-1.4V1l6.5-.8v19.3zm-4.8-.8V9.5c-.5-.6-1.2-.9-1.9-.9-1.6 0-3.1 1.4-3.1 5.7 0 4 1.3 5.4 3 5.4.8.1 1.6-.3 2-1zm9.1 3.1V9.4c0-.3-.1-.6-.3-.7l-1.4-1.5v-.1h6.5v12.5c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5zm-.2-19.2C60.4 1.2 61.5 0 63 0c1.4 0 2.6 1.2 2.6 2.6S64.4 5.3 63 5.3c-1.5 0-2.6-1.2-2.6-2.7zm22.5 16.9c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5v-3.2c-.6 2-2.4 3.4-4.5 3.4-2.9 0-4.4-2.1-4.4-6.2 0-1.9 0-4.1.1-6.5 0-.3-.1-.5-.3-.7L67.7 7v.1H74v8c0 2.6.4 4.4 2 4.4.9-.1 1.7-.6 2.1-1.3V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v12.4zm22 2.3c0-.5.1-6.5.1-7.9 0-2.6-.4-4.5-2.2-4.5-.9 0-1.8.5-2.3 1.3.2.8.3 1.7.3 2.5 0 1.8-.1 4.2-.1 6.5 0 .3.1.5.3.7l1.5 1.4v.1H96c0-.4.1-6.5.1-7.9 0-2.7-.4-4.5-2.2-4.5-.9 0-1.7.5-2.2 1.3v9c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v3.1c.6-2.1 2.5-3.5 4.6-3.4 2.2 0 3.6 1.2 4.2 3.5.7-2.1 2.7-3.6 4.9-3.5 2.9 0 4.5 2.2 4.5 6.2 0 1.9-.1 4.2-.1 6.5-.1.3.1.6.3.7l1.4 1.4v.1h-6.6zm-81.4-2l1.9 1.9v.1h-9.8v-.1l2-1.9c.2-.2.3-.4.3-.7V7.3c0-.5 0-1.2.1-1.8L11.4 22h-.1L4.5 6.8c-.1-.4-.2-.4-.3-.6v10c-.1.7 0 1.3.3 1.9l2.7 3.6v.1H0v-.1L2.7 18c.3-.6.4-1.3.3-1.9v-11c0-.5-.1-1.1-.5-1.5L.7 1.1V1h7l5.8 12.9L18.6 1h6.8v.1l-1.9 2.2c-.2.2-.3.5-.3.7v15.2c0 .2.1.5.3.6zm7.6-5.9c0 3.8 1.9 5.3 4.2 5.3 1.9.1 3.6-1 4.4-2.7h.1c-.8 3.7-3.1 5.5-6.5 5.5-3.7 0-7.2-2.2-7.2-7.4 0-5.5 3.5-7.6 7.3-7.6 3.1 0 6.4 1.5 6.4 6.2v.8h-8.7zm0-.8h4.3v-.8c0-3.9-.8-4.9-2-4.9-1.4.1-2.3 1.6-2.3 5.7z"></path></svg>'
  })

  var youtubeLogo = Vue.component('medium-logo', {
    template: `
      <div class="flex items-center">
        <img src="../assets/images/youtube.svg" class="mr-2" height="22" alt="">
        YouTube
      </div>
    `
  })

  new Vue({
    el: '#app',
    data () {
      return {
        recentContent: [],
        paynowCollapsed: true,
        isLoading: false,
        message: '',
        authemail: '',
        mobileMoneyProvider: 'ecocash',
        mobileNumber: '',
        amount: 5
      }
    },
    components: {
      mediumLogo,
      youtubeLogo
    },
    created () {
      axios
        .get('/api/recent-content.json')
        .then((res) =>  {
          this.recentContent = res.data.data
          console.log(res.data.data)
        })
        .catch(function (error) {
          console.log(error)
        })
    },
    mounted () {
      // conso
      var typed = new Typed('.sponsor-header__dynamic-text', {
        strings: ["Keep making awesome videos", "Keep making awesome videos", "Continue providing free content", "Build Awesome Stuff"],
        typeSpeed: 80,
        backSpeed: 20,
        loop: true,
        loopCount: Infinity,
      });
    },
    methods: {
      choosePaynow () {
        if (this.paynowCollapsed === false) {
          if (this.validateInputs()) {
            // proceed with the paynow request
          }
          return this.initiateMobileTransaction()
        }
        this.paynowCollapsed = false
      },

      validateInputs () {
        // validate email
        // Validate amount
        // return results
      },

      initiateMobileTransaction () {
        this.isLoading = true
        axios
          .post('http://localhost:3000/pay/mobile', {
            "products": [
              { "itemName": "donation", "price": this.amount }
            ],
            "mobileMoneyProvider": this.mobileMoneyProvider,
            "mobileNumber": this.mobileNumber,
            "authemail": this.authemail
          })
          .then(response => {
            console.log(response)
            this.message = response.data.instructions
          })
          .catch(error => {
            console.dir(error)
            this.message = 'An error occured whilst attempting to send money. Please try again.'
          })
          .finally(() => {
            this.isLoading = false
          })
      }
    }
  })
</script>

<!-- Start of Async Drift Code -->
<script>
  "use strict";
  
  !function() {
    var t = window.driftt = window.drift = window.driftt || [];
    if (!t.init) {
      if (t.invoked) return void (window.console && console.error && console.error("Drift snippet included twice."));
      t.invoked = !0, t.methods = [ "identify", "config", "track", "reset", "debug", "show", "ping", "page", "hide", "off", "on" ], 
      t.factory = function(e) {
        return function() {
          var n = Array.prototype.slice.call(arguments);
          return n.unshift(e), t.push(n), t;
        };
      }, t.methods.forEach(function(e) {
        t[e] = t.factory(e);
      }), t.load = function(t) {
        var e = 3e5, n = Math.ceil(new Date() / e) * e, o = document.createElement("script");
        o.type = "text/javascript", o.async = !0, o.crossorigin = "anonymous", o.src = "https://js.driftt.com/include/" + n + "/" + t + ".js";
        var i = document.getElementsByTagName("script")[0];
        i.parentNode.insertBefore(o, i);
      };
    }
  }();
  drift.SNIPPET_VERSION = '0.3.1';
  drift.load('absv4ha4mm7u');
  </script>
  <!-- End of Async Drift Code -->
</html>